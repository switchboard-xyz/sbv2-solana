{
  "fileName": "crankAccount.ts",
  "filePath": "javascript/solana.js/src/accounts/crankAccount.ts",
  "url": "https://github.com/switchboard-xyz/sbv2-solana/blob/master/javascript/solana.js/src/accounts/crankAccount.ts",
  "summary": "The `CrankAccount` class in this code is responsible for managing a priority queue of aggregators and their next available update time. This scheduling mechanism ensures that `AggregatorAccount`s are updated as close as possible to their specified update interval.\n\nThe class provides several methods to interact with the crank account, such as `load`, `loadData`, `createInstructions`, `create`, `pushInstruction`, `push`, `popInstruction`, `pop`, `peakNextWithTime`, `peakNextReady`, `peakNext`, `loadCrank`, `isOnCrank`, `fetchAccounts`, and `toAccountsJSON`.\n\nFor example, the `create` method creates a new `CrankAccount` and initializes it with the provided parameters. The `push` method pushes a new aggregator onto the crank, while the `pop` method pops the next readily updateable aggregator from the crank.\n\nThe `peakNextWithTime` method returns an array of the next aggregator pubkeys to be popped from the crank, limited by a specified number. The `peakNextReady` method returns an array of the next readily updateable aggregator pubkeys to be popped from the crank, limited by a specified number.\n\nHere's an example of how to create a new `CrankAccount`:\n\n```javascript\nconst [crankAccount, txnSignature] = await CrankAccount.create(\n  program,\n  {\n    queueAccount: queueAccountInstance,\n    name: 'exampleCrank',\n    metadata: 'exampleMetadata',\n    maxRows: 500,\n  }\n);\n```\n\nAnd here's an example of how to push an aggregator onto the crank:\n\n```javascript\nconst txnSignature = await crankAccount.push({\n  aggregatorAccount: aggregatorAccountInstance,\n});\n```\n\nThis code is part of a larger project that deals with managing and updating data feeds on the Solana blockchain. The `CrankAccount` class plays a crucial role in scheduling updates for these data feeds.",
  "questions": "1. **Question**: What is the purpose of the `CrankAccount` class and how does it relate to the `AggregatorAccount` class?\n\n   **Answer**: The `CrankAccount` class represents an account holding a priority queue of aggregators and their next available update time. It acts as a scheduling mechanism to ensure `AggregatorAccount` instances are updated as close as possible to their specified update interval.\n\n2. **Question**: How does the `peakNextReady` function work and what does it return?\n\n   **Answer**: The `peakNextReady` function returns an array of the next readily updateable aggregator public keys to be popped from the crank, limited by the given number `num`. It filters the aggregator public keys based on whether their next available update timestamp is less than or equal to the current Unix timestamp.\n\n3. **Question**: What are the `CrankInitParams`, `CrankPushParams`, and `CrankPopParams` interfaces used for?\n\n   **Answer**: These interfaces define the parameters required for various operations on the `CrankAccount` class. `CrankInitParams` is used for initializing a `CrankAccount`, `CrankPushParams` is used for pushing an aggregator onto the crank, and `CrankPopParams` is used for popping an element from the crank."
}